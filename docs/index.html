<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Budget Buddy - Track Your Expenses</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#1a73e8">
    <link rel="apple-touch-icon" href="icon-192.png">
</head>
<body>
    <!-- Login Screen -->
    <div id="loginScreen" class="screen active">
        <div class="login-container">
            <h1>Budget Buddy</h1>
            <p>Track your expenses effortlessly</p>
            <button id="googleSignInBtn" class="google-signin-btn">
                <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg" alt="Google">
                Sign in with Google
            </button>
        </div>
    </div>

    <!-- Main App -->
    <div id="mainApp" class="screen">
        <!-- Header -->
        <header class="app-header">
            <h1>Budget Buddy</h1>
            <div class="header-actions">
                <span id="userEmail" class="user-email"></span>
                <button id="signOutBtn" class="sign-out-btn">Sign Out</button>
            </div>
        </header>

        <!-- Navigation -->
        <nav class="bottom-nav">
            <button class="nav-btn" data-view="dashboard">
                <span class="nav-icon">üè†</span>
                <span>Dashboard</span>
            </button>
            <button class="nav-btn active" data-view="entry">
                <span class="nav-icon">+</span>
                <span>Add</span>
            </button>
            <button class="nav-btn" data-view="recent">
                <span class="nav-icon">üìã</span>
                <span>Recent</span>
            </button>
            <button class="nav-btn" data-view="summary">
                <span class="nav-icon">üìä</span>
                <span>Summary</span>
            </button>
        </nav>

        <!-- Quick Stats (Hidden when dashboard is active) -->
        <div class="quick-stats" id="quickStats">
            <div class="stat-card">
                <h3>Neo Card</h3>
                <p class="stat-amount" id="neoTotal">$0.00</p>
            </div>
            <div class="stat-card">
                <h3>RBC Card</h3>
                <p class="stat-amount" id="rbcTotal">$0.00</p>
            </div>
        </div>

        <!-- Views Container -->
        <div class="views-container">
            <!-- Dashboard View -->
            <div id="dashboardView" class="view">
                <div class="dashboard-header">
                    <h2>Budget Overview</h2>
                    <button id="manageBudgetBtn" class="manage-budget-btn">‚öôÔ∏è Manage Budget</button>
                </div>
                
                <div class="month-summary">
                    <div class="summary-card">
                        <h3>Monthly Status</h3>
                        <div class="summary-stats">
                            <div class="stat-item">
                                <span class="stat-label">Spent</span>
                                <span class="stat-value" id="totalSpent">$0</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">Budget</span>
                                <span class="stat-value" id="totalBudget">$0</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">Remaining</span>
                                <span class="stat-value" id="totalRemaining">$0</span>
                            </div>
                        </div>
                        <div class="overall-progress">
                            <div class="progress-bar">
                                <div class="progress-fill" id="overallProgress" style="width: 0%"></div>
                            </div>
                            <span class="progress-text" id="overallProgressText">0% of budget used</span>
                        </div>
                    </div>
                    
                    <div class="summary-insights">
                        <div class="insight-item">
                            <span class="insight-icon">üìÖ</span>
                            <span id="daysRemaining">30 days remaining</span>
                        </div>
                        <div class="insight-item">
                            <span class="insight-icon">üí∞</span>
                            <span id="dailyAverage">$0/day average</span>
                        </div>
                    </div>
                </div>
                
                <div class="budget-categories" id="budgetCategories">
                    <!-- Category budget cards will be dynamically inserted here -->
                </div>
                
                <div class="budget-alerts" id="budgetAlerts" style="display: none;">
                    <!-- Alert messages will be dynamically inserted here -->
                </div>
            </div>
            
            <!-- Entry View -->
            <div id="entryView" class="view active">
                <form id="expenseForm" class="expense-form">
                    <!-- Card Selection -->
                    <div class="card-selection">
                        <button type="button" class="card-btn" data-card="neo">Neo</button>
                        <button type="button" class="card-btn active" data-card="rbc">RBC</button>
                    </div>

                    <!-- Amount Input -->
                    <div class="amount-input-container">
                        <span class="currency-symbol">$</span>
                        <input type="number" id="amountInput" class="amount-input" placeholder="0.00" step="0.01" required autofocus>
                    </div>

                    <!-- Category Grid -->
                    <div class="category-grid">
                        <button type="button" class="category-btn" data-category="food">
                            <span class="category-icon">üçî</span>
                            <span>Food</span>
                        </button>
                        <button type="button" class="category-btn" data-category="delivery">
                            <span class="category-icon">üöö</span>
                            <span>Delivery</span>
                        </button>
                        <button type="button" class="category-btn" data-category="groceries">
                            <span class="category-icon">üõí</span>
                            <span>Groceries</span>
                        </button>
                        <button type="button" class="category-btn" data-category="shopping">
                            <span class="category-icon">üõçÔ∏è</span>
                            <span>Shopping</span>
                        </button>
                        <button type="button" class="category-btn" data-category="entertainment">
                            <span class="category-icon">üé¨</span>
                            <span>Entertainment</span>
                        </button>
                        <button type="button" class="category-btn" data-category="other">
                            <span class="category-icon">üì¶</span>
                            <span>Other</span>
                        </button>
                    </div>

                    <!-- Description (Optional) -->
                    <input type="text" id="descriptionInput" class="description-input" placeholder="Description (optional)">

                    <!-- Save Button -->
                    <button type="submit" class="save-btn">SAVE EXPENSE</button>
                </form>

                <!-- Success Message -->
                <div id="successMessage" class="success-message">Expense saved!</div>
            </div>

            <!-- Recent View -->
            <div id="recentView" class="view">
                <div class="filter-controls">
                    <select id="cardFilter" class="filter-select">
                        <option value="all">All Cards</option>
                        <option value="neo">Neo Card</option>
                        <option value="rbc">RBC Card</option>
                    </select>
                    <input type="text" id="searchInput" class="search-input" placeholder="Search expenses...">
                </div>
                <div id="recentExpenses" class="expenses-list"></div>
            </div>

            <!-- Summary View -->
            <div id="summaryView" class="view">
                <div class="summary-controls">
                    <div class="filter-row">
                        <button class="period-btn active" data-period="week">This Week</button>
                        <button class="period-btn" data-period="month">This Month</button>
                        <button class="period-btn" data-period="lastMonth">Last Month</button>
                        <button class="period-btn" data-period="year">This Year</button>
                        <button class="period-btn" data-period="custom">Custom</button>
                    </div>
                    <div class="date-filter-row" id="dateFilterRow" style="display: none;">
                        <input type="date" id="startDate" class="date-input">
                        <span>to</span>
                        <input type="date" id="endDate" class="date-input">
                        <button id="applyDateFilter" class="apply-btn">Apply</button>
                    </div>
                    <div class="filter-info" id="filterInfo"></div>
                </div>
                <div id="categoryBreakdown" class="category-breakdown"></div>
                <button id="exportBtn" class="export-btn">Export to CSV</button>
            </div>
        </div>
    </div>

    <!-- Budget Management Modal -->
    <div id="budgetModal" class="modal">
        <div class="modal-content">
            <h2>Manage Monthly Budget</h2>
            <p class="modal-subtitle">Set your budget for each category</p>
            <form id="budgetForm">
                <div class="budget-inputs">
                    <div class="budget-input-group">
                        <label>
                            <span class="category-icon">üçî</span>
                            Food
                        </label>
                        <input type="number" id="budgetFood" class="budget-input" placeholder="0" step="1" min="0">
                    </div>
                    <div class="budget-input-group">
                        <label>
                            <span class="category-icon">üöö</span>
                            Delivery
                        </label>
                        <input type="number" id="budgetDelivery" class="budget-input" placeholder="0" step="1" min="0">
                    </div>
                    <div class="budget-input-group">
                        <label>
                            <span class="category-icon">üõí</span>
                            Groceries
                        </label>
                        <input type="number" id="budgetGroceries" class="budget-input" placeholder="0" step="1" min="0">
                    </div>
                    <div class="budget-input-group">
                        <label>
                            <span class="category-icon">üõçÔ∏è</span>
                            Shopping
                        </label>
                        <input type="number" id="budgetShopping" class="budget-input" placeholder="0" step="1" min="0">
                    </div>
                    <div class="budget-input-group">
                        <label>
                            <span class="category-icon">üé¨</span>
                            Entertainment
                        </label>
                        <input type="number" id="budgetEntertainment" class="budget-input" placeholder="0" step="1" min="0">
                    </div>
                    <div class="budget-input-group">
                        <label>
                            <span class="category-icon">üì¶</span>
                            Other
                        </label>
                        <input type="number" id="budgetOther" class="budget-input" placeholder="0" step="1" min="0">
                    </div>
                </div>
                <div class="budget-total">
                    <span>Total Budget:</span>
                    <span id="budgetTotalPreview">$0</span>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn-secondary" onclick="closeBudgetModal()">Cancel</button>
                    <button type="submit" class="btn-primary">Save Budget</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Edit Modal -->
    <div id="editModal" class="modal">
        <div class="modal-content">
            <h2>Edit Expense</h2>
            <form id="editForm">
                <input type="hidden" id="editExpenseId">
                <div class="form-group">
                    <label>Card</label>
                    <select id="editCard" class="form-input">
                        <option value="neo">Neo Card</option>
                        <option value="rbc">RBC Card</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Amount</label>
                    <input type="number" id="editAmount" class="form-input" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Category</label>
                    <select id="editCategory" class="form-input">
                        <option value="food">Food</option>
                        <option value="delivery">Delivery</option>
                        <option value="groceries">Groceries</option>
                        <option value="shopping">Shopping</option>
                        <option value="entertainment">Entertainment</option>
                        <option value="other">Other</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Description</label>
                    <input type="text" id="editDescription" class="form-input">
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn-secondary" onclick="closeEditModal()">Cancel</button>
                    <button type="submit" class="btn-primary">Save Changes</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Firebase Scripts -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    
    <!-- App Scripts -->
    <script src="firebase-config.js"></script>
    <script src="app.js"></script>
</body>
</html>